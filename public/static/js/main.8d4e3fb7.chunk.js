(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{169:function(e,t,a){e.exports=a(373)},174:function(e,t,a){},178:function(e,t,a){},350:function(e,t,a){},369:function(e,t,a){},370:function(e,t,a){},371:function(e,t,a){},373:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(8),o=a.n(i),l=(a(174),a(29)),s=a(30),c=a(33),u=a(31),m=a(34),h=a(377),d=a(379),p=a(378),f=(a(50),a(18)),b=(a(86),a(49)),v=(a(113),a(57)),g=a(24),E=a(376),S=(a(178),function(){return r.a.createElement("header",{className:"Header"},r.a.createElement("h2",null,"Photo Book"))}),C=(a(179),a(165)),j=a(67),O=(a(375),a(112)),w=(a(374),a(163)),y=(a(186),a(164)),A=(a(188),a(9)),k=a(166),V=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={images:[],previewVisible:!1,previewImage:""},a.uploadImage=function(e){var t=e.file,n=(e.filename,e.onError),r=e.onProgress,i=e.onSuccess,o=new FileReader;o.onloadend=function(){a.setState(function(e){return{images:[].concat(Object(k.a)(e.images),[Object(g.a)({},t,{url:o.result})])}}),a.props.onImageUpload(a.state.images),i(o.result,t)},o.onprogress=r,o.onerror=n,o.readAsDataURL(t)},a.handleDismissPreview=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(e){a.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.images;e&&this.setState({images:e})}},{key:"componentWillReceiveProps",value:function(e){e.images!==this.props.images&&this.setState({images:e.images})}},{key:"render",value:function(){var e=this.state,t=e.images,a=e.previewImage,n=e.previewVisible;return r.a.createElement(w.a,{name:"avatar",listType:"picture-card",className:"avatar-uploader",defaultFileList:t,showUploadList:!0,customRequest:this.uploadImage,onPreview:this.handlePreview},r.a.createElement("div",null,r.a.createElement(A.a,{type:"plus"}),r.a.createElement("div",{className:"ant-upload-text"},"Upload")),r.a.createElement(y.a,{visible:n,footer:null,onCancel:this.handleDismissPreview},r.a.createElement("img",{alt:"Vendor visual",style:{width:"100%"},src:a})))}}]),t}(n.Component),I=b.a.TextArea,P=O.a.Item,N=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={formVisible:!1,form:{values:{photos:[],title:"",desc:""},errors:{title:"",desc:"",photo:""}}},a.onClose=function(){a.setState({formVisible:!1})},a.handleValueChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(function(e){return{form:{values:Object(g.a)({},e.form.values,Object(j.a)({},n,r)),errors:Object(g.a)({},e.form.errors,Object(j.a)({},n,""))}}})},a.handleImageUpload=function(e){var t=e.map(function(e){return e.url});a.setState(function(e){return{form:{errors:Object(g.a)({},e.form.errors,{photo:""}),values:Object(g.a)({},e.form.values,{photos:t})}}})},a.handleSubmit=function(e){e.preventDefault();var t=a.state.form,n=a.props.hideTitleField;!n||t.values.desc&&t.values.photos.length?n||t.values.title&&t.values.desc&&t.values.photos.length?a.props.onSubmit(a.state.form.values):a.setState(function(e){return{form:{errors:{title:t.values.title?"":"Title is required",desc:t.values.desc?"":"Description is required",photo:t.values.photos.length?"":"Photo is required"},values:Object(g.a)({},e.form.values)}}}):a.setState(function(e){return{form:{errors:{desc:t.values.desc?"":"Description is required",photo:t.values.photos.length?"":"Photo is required"},values:Object(g.a)({},e.form.values)}}})},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.form,t=this.props,a=t.visible,n=t.onClose,i=t.title,o=t.submitting,l=t.hideTitleField;return r.a.createElement(C.a,{title:i,placement:"right",closable:!0,maskClosable:!1,width:"50%",onClose:n,visible:a},r.a.createElement(O.a,{layout:"vertical",onSubmit:this.handleSubmit},l?null:r.a.createElement(P,{label:"Title",help:e.errors.title||"",validateStatus:e.errors.title?"error":""},r.a.createElement(b.a,{placeholder:"Title",name:"title",value:e.values.title,onChange:this.handleValueChange})),r.a.createElement(P,{label:"Description",help:e.errors.desc||"",validateStatus:e.errors.desc?"error":""},r.a.createElement(I,{placeholder:"Description",name:"desc",value:e.values.desc,onChange:this.handleValueChange})),r.a.createElement(P,{label:"Photos",help:e.errors.photo||"",validateStatus:e.errors.photo?"error":""},r.a.createElement(V,{onImageUpload:this.handleImageUpload})),r.a.createElement(P,null,r.a.createElement(f.a,{type:"primary",htmlType:"submit",loading:o},"Submit"))))}}]),t}(n.Component),q=(a(350),function(e){var t=e.style,a=e.src,n=e.title,i=e.desc;return r.a.createElement("figure",{className:"ImgCard",style:t},r.a.createElement("div",{className:"ImgCard-img-wrapper"},r.a.createElement("div",{className:"ImgCard-img","data-testid":"image",style:{backgroundImage:"url(".concat(a,")")}}),r.a.createElement("div",{className:"ImgCard-mask"},r.a.createElement("h3",{className:"ImgCard-title"},n))),r.a.createElement("figcaption",null,i))}),D=a(111),U=a.n(D);U.a.defaults.baseURL=Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_API_BASE_URL;var T=U.a.create({headers:{Accept:"application/json"}}),R=function(e){return T.post("/albums",e).then(function(e){return e.data})},L=function(e){return T.post("/photos",e).then(function(e){return e.data})},F=function(e){return T.get("/albums",{params:e}).then(function(e){return e.data})},_=function(e){return T.get("/photos",{params:e}).then(function(e){return e.data})},B=function(e){return T.get("/photos/search",{params:e}).then(function(e){return e.data})},x=function(e){return T.get("/albums/search",{params:e}).then(function(e){return e.data})},H=(a(369),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={formVisible:!1,q:"",submitting:!1,albums:{}},a.loadAlbums=function(){var e={};F().then(function(t){t.forEach(function(t){e[t.id]=t});var a=t.map(function(e){return _({album:e.id})});return Promise.all(a)}).then(function(t){var n={};t.forEach(function(t){if(t.length){var a=t[0].album;n[a]=Object(g.a)({},e[a],{photos:t})}}),a.setState({albums:n})})},a.handleCreateAlbumClick=function(){a.setState({formVisible:!0})},a.onClose=function(){a.setState({formVisible:!1})},a.handleValueChange=function(e){var t=e.target.value;a.setState({q:e.target.value}),setTimeout(function(){if(t){var e={};x({q:t}).then(function(t){t.forEach(function(t){e[t.id]=t});var a=t.map(function(e){return _({album:e.id})});return Promise.all(a)}).then(function(t){var n={};t.forEach(function(t){if(t.length){var a=t[0].album;n[a]=Object(g.a)({},e[a],{photos:t})}}),a.setState({albums:n})})}else a.loadAlbums()},500)},a.handleSubmit=function(e){var t=e.title,n=e.desc,r=e.photos;a.setState({submitting:!0}),R({title:t,description:n}).then(function(e){var t=e.id,a=r.map(function(e){return{uri:e,album:t}});return L(a)}).then(function(){a.setState({submitting:!1,formVisible:!1,title:"",photos:[]}),v.a.success("Album has been successfully created"),a.loadAlbums()}).catch(function(){a.setState({submitting:!1,formVisible:!1,title:"",photos:[]}),v.a.error("album creation failed")})},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.loadAlbums()}},{key:"render",value:function(){var e=this.state,t=e.albums,a=e.formVisible,n=e.submitting,i=e.q;return r.a.createElement("section",null,r.a.createElement(S,null),r.a.createElement("section",{className:"Home-content"},r.a.createElement("h3",null,"Discover Amazing Albums"),r.a.createElement("div",{className:"Home-actions"},r.a.createElement(b.a,{placeholder:"Search Albums using keywords...",value:i,onChange:this.handleValueChange}),"\xa0\xa0",r.a.createElement(f.a,{icon:"plus",onClick:this.handleCreateAlbumClick},"Create New Album")),r.a.createElement("div",{className:"Home-albums"},Object.keys(t).length?Object.keys(t).map(function(e){return r.a.createElement(E.a,{key:e,to:"albums/".concat(t[e].id),title:"Click to view this album"},r.a.createElement(q,{src:t[e].photos[0].uri,title:t[e].title}))}):""),r.a.createElement(N,{title:"New Album",visible:a,submitting:n,onSubmit:this.handleSubmit,onClose:this.onClose})))}}]),t}(n.Component)),M=(a(370),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={photos:[],title:"",q:"",formVisible:!1,submitting:!1},a.handleImageUpload=function(e){a.setState({photos:e})},a.handleAddPhotoClick=function(){a.setState({formVisible:!0})},a.onClose=function(){a.setState({formVisible:!1})},a.handleValueChange=function(e){var t=e.target.value;a.setState({q:e.target.value}),setTimeout(function(){if(t)B({q:t}).then(function(e){return a.setState({photos:e})});else{var e=a.props.match.params.albumId;_({album:e}).then(function(e){a.setState({photos:e})})}},500)},a.handleSubmit=function(e){var t=a.props.match.params.albumId,n=e.photos.map(function(a){return{uri:a,description:e.desc,album:t}});a.setState({submitting:!0}),L(n).then(function(){a.setState({submitting:!1,formVisible:!1}),v.a.success("Picture added successfully"),_({album:t}).then(function(e){a.setState({photos:e})})}).catch(function(){a.setState({submitting:!1,formVisible:!1}),v.a.error(" add picture fails")})},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.albumId,a=function(e){return T.get("/albums/".concat(e)).then(function(e){return e.data})}(t).then(function(t){e.setState({title:t.title})}),n=_({album:t}).then(function(t){e.setState({photos:t})});Promise.all([a,n])}},{key:"render",value:function(){var e=this.state,t=e.title,a=e.photos,i=e.formVisible,o=e.submitting,l=e.q;return r.a.createElement("section",null,r.a.createElement(S,null),r.a.createElement("section",{className:"Album"},r.a.createElement("h2",{className:"Album-header"},t," Album "),r.a.createElement("div",{className:"Album-filter"},r.a.createElement(b.a,{placeholder:"Search photos using keywords...",value:l,onChange:this.handleValueChange}),"\xa0\xa0",r.a.createElement(f.a,{icon:"plus",onClick:this.handleAddPhotoClick},"Add photo")),r.a.createElement("div",{className:"Album-pictures"},r.a.createElement(n.Fragment,null,a.map(function(e){return r.a.createElement(q,{key:e.id,desc:e.description,src:e.uri})})))),r.a.createElement(N,{title:"New Photo",visible:i,submitting:o,onSubmit:this.handleSubmit,onClose:this.onClose,hideTitleField:!0}))}}]),t}(n.Component)),W=(a(371),function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,null,r.a.createElement(d.a,null,r.a.createElement(p.a,{exact:!0,path:"/",component:H}),r.a.createElement(p.a,{path:"/albums/:albumId",component:M})))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[169,1,2]]]);
//# sourceMappingURL=main.8d4e3fb7.chunk.js.map